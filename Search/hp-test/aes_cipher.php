<?php

class AesCipher {

	private $_key;

	public function __construct($key) {
		$this->_key = $key;
	}
	
	function _decrypt_data($data, $key) {
		$cypher = mcrypt_module_open(MCRYPT_RIJNDAEL_128, '', MCRYPT_MODE_ECB, '');

		// initialize encryption handle
		if (mcrypt_generic_init($cypher, $key, null) != -1) {
				// decrypt
				$decrypted = mdecrypt_generic($cypher, $data);

				// clean up
				mcrypt_generic_deinit($cypher);
				mcrypt_module_close($cypher);

				return $decrypted;
		}

		return null;
	}

	public function _decrypt($input) {
		$input2 = base64_decode($input);
		return $this->_decrypt_data($input2, $this->_key);
	}
}

if (false) {
	$key = "PalBfHNjEoJ9Ie0m"."f449b140c485c796";
	$msg = "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";
	$aesCipher = new AesCipher($key);
	$res = $aesCipher->_decrypt($msg);
	echo "res=".$res."<br /><br /><br />";
	$pos = strrpos($res, "}}");
	$res2 = substr($res, 0, $pos + 2);
	echo "res2=".$res2."<br />";
}

if (false) {
	$key = "PalBfHNjEoJ9Ie0m"."dfeac6453dbf9c49";
	$msg = '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';
	$aesCipher = new AesCipher($key);
	$res = $aesCipher->_decrypt($msg);
	echo "res=".$res."<br /><br /><br />";
	$pos = strrpos($res, "}}");
	$res2 = substr($res, 0, $pos + 2);
	echo "res2=".$res2."<br />";	
}
?>
